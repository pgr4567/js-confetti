!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).jsConfetti=e()}(this,(function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function o(t,e){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=function(t,e){if(t){if("string"==typeof t)return n(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?n(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var o=0,s=function(){};return{s:s,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r=!0,h=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return r=t.done,t},e:function(t){h=!0,a=t},f:function(){try{r||null==i.return||i.return()}finally{if(h)throw a}}}}function s(t){return+t.replace(/px/,"")}function a(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=Math.random()*(e-t)+t;return Math.floor(n*Math.pow(10,i))/Math.pow(10,i)}function r(t){return t[a(0,t.length)]}var h=["#fcf403","#62fc03","#f4fc03","#03e7fc","#03fca5","#a503fc","#fc03ad","#fc03c2"];function u(t){return Math.log(t)/Math.log(1920)}var c=function(){function e(i){t(this,e);var n=i.initialPosition,o=i.direction,s=i.confettiRadius,h=i.confettiColors,c=i.emojis,l=i.emojiSize,f=i.canvasWidth,d=a(.9,1.7,3)*u(f);this.confettiSpeed={x:d,y:d},this.finalConfettiSpeedX=a(.2,.6,3),this.rotationSpeed=c.length?.01:a(.03,.07,3)*u(f),this.dragForceCoefficient=a(5e-4,9e-4,6),this.radius={x:s,y:s},this.initialRadius=s,this.rotationAngle="left"===o?a(0,.2,3):a(-.2,0,3),this.emojiSize=l,this.emojiRotationAngle=a(0,2*Math.PI),this.radiusYUpdateDirection="down";var v="left"===o?a(82,15)*Math.PI/180:a(-15,-82)*Math.PI/180;this.absCos=Math.abs(Math.cos(v)),this.absSin=Math.abs(Math.sin(v));var m=a(-150,0),p={x:n.x+("left"===o?-m:m)*this.absCos,y:n.y-m*this.absSin};this.currentPosition=Object.assign({},p),this.initialPosition=Object.assign({},p),this.color=c.length?null:r(h),this.emoji=c.length?r(c):null,this.createdAt=(new Date).getTime(),this.direction=o}return i(e,[{key:"draw",value:function(t){var e=this.currentPosition,i=this.radius,n=this.color,o=this.emoji,s=this.rotationAngle,a=this.emojiRotationAngle,r=this.emojiSize,h=window.devicePixelRatio;n?(t.fillStyle=n,t.beginPath(),t.ellipse(e.x*h,e.y*h,i.x*h,i.y*h,s,0,2*Math.PI),t.fill()):o&&(t.font="".concat(r,"px serif"),t.save(),t.translate(h*e.x,h*e.y),t.rotate(a),t.textAlign="center",t.fillText(o,0,0),t.restore())}},{key:"updatePosition",value:function(t,e){var i=this.confettiSpeed,n=this.dragForceCoefficient,o=this.finalConfettiSpeedX,s=this.radiusYUpdateDirection,a=this.rotationSpeed,r=this.createdAt,h=this.direction,u=e-r;i.x>o&&(this.confettiSpeed.x-=n*t),this.currentPosition.x+=i.x*("left"===h?-this.absCos:this.absCos)*t,this.currentPosition.y=this.initialPosition.y-i.y*this.absSin*u+.00125*Math.pow(u,2)/2,this.rotationSpeed-=this.emoji?1e-4:1e-5*t,this.rotationSpeed<0&&(this.rotationSpeed=0),this.emoji?this.emojiRotationAngle+=this.rotationSpeed*t%(2*Math.PI):"down"===s?(this.radius.y-=t*a,this.radius.y<=0&&(this.radius.y=0,this.radiusYUpdateDirection="up")):(this.radius.y+=t*a,this.radius.y>=this.initialRadius&&(this.radius.y=this.initialRadius,this.radiusYUpdateDirection="down"))}},{key:"getIsVisibleOnCanvas",value:function(t){return this.currentPosition.y<t+100}}]),e}();function l(t){var e=t.confettiRadius,i=void 0===e?6:e,n=t.confettiNumber,o=void 0===n?t.emojis?40:250:n,s=t.confettiColors,a=void 0===s?h:s,r=t.emojis,u=void 0===r?[]:r,c=t.emojiSize;return{confettiRadius:i,confettiNumber:o,confettiColors:a,emojis:u,emojiSize:void 0===c?80:c}}var f=function(){function e(i){var n=this;t(this,e),this.canvasContext=i,this.shapes=[],this.promise=new Promise((function(t){return n.resolvePromise=t}))}return i(e,[{key:"getBatchCompletePromise",value:function(){return this.promise}},{key:"addShapes",value:function(){var t;(t=this.shapes).push.apply(t,arguments)}},{key:"complete",value:function(){var t;return!this.shapes.length&&(null===(t=this.resolvePromise)||void 0===t||t.call(this),!0)}},{key:"processShapes",value:function(t,e,i){var n=this,o=t.timeDelta,s=t.currentTime;this.shapes=this.shapes.filter((function(t){return t.updatePosition(o,s),t.draw(n.canvasContext),!i||t.getIsVisibleOnCanvas(e)}))}}]),e}(),d=function(){function e(){var i,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t(this,e),this.activeConfettiBatches=[],this.canvas=n.canvas||((i=document.createElement("canvas")).style.position="fixed",i.style.width="100%",i.style.height="100%",i.style.top="0",i.style.left="0",i.style.zIndex="1000",i.style.pointerEvents="none",document.body.appendChild(i),i),this.canvasContext=this.canvas.getContext("2d"),this.requestAnimationFrameRequested=!1,this.lastUpdated=(new Date).getTime(),this.iterationIndex=0,this.loop=this.loop.bind(this),requestAnimationFrame(this.loop)}return i(e,[{key:"loop",value:function(){var t,e,i,n,o;this.requestAnimationFrameRequested=!1,t=this.canvas,e=window.devicePixelRatio,i=getComputedStyle(t),n=s(i.getPropertyValue("width")),o=s(i.getPropertyValue("height")),t.setAttribute("width",(n*e).toString()),t.setAttribute("height",(o*e).toString());var a=(new Date).getTime(),r=a-this.lastUpdated,h=this.canvas.offsetHeight,u=this.iterationIndex%10==0;this.activeConfettiBatches=this.activeConfettiBatches.filter((function(t){return t.processShapes({timeDelta:r,currentTime:a},h,u),!u||!t.complete()})),this.iterationIndex++,this.queueAnimationFrameIfNeeded(a)}},{key:"queueAnimationFrameIfNeeded",value:function(t){this.requestAnimationFrameRequested||this.activeConfettiBatches.length<1||(this.requestAnimationFrameRequested=!0,this.lastUpdated=t||(new Date).getTime(),requestAnimationFrame(this.loop))}},{key:"addConfetti",value:function(t){var e,i,n=this.canvas.getBoundingClientRect(),s=n.width,a=n.height,r=new f(this.canvasContext),h=o(t);try{for(h.s();!(e=h.n()).done;)for(var u=e.value,d=l(u),v=d.confettiRadius,m=d.confettiNumber,p=d.confettiColors,y=d.emojis,g=d.emojiSize,b=0;b<m/2;b++){var C=new c({initialPosition:(i=u.confettiPosition||{x:0,y:.5},{x:i.x*s,y:i.y*a}),direction:u.confettiDirection||"right",confettiRadius:v,confettiColors:p,confettiNumber:m,emojis:y,emojiSize:g,canvasWidth:s});r.addShapes(C)}}catch(t){h.e(t)}finally{h.f()}return this.activeConfettiBatches.push(r),this.queueAnimationFrameIfNeeded(),r.getBatchCompletePromise()}},{key:"clearCanvas",value:function(){this.activeConfettiBatches=[]}},{key:"destroyCanvas",value:function(){this.canvas.remove()}}]),e}();return d}));
